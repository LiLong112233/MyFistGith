<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<form action="/index.php/index/Index/bookdo" method="post" enctype="multipart/form-data">
    <table border="1">
        <tr>
            <td>å›¾ä¹¦åç§°</td>
            <td><input type="text" name="b_name" id="b_name" onblur="check_name()">
            <span id="span_name"></span>
            </td>
        </tr>
        <tr>
            <td>ä½œè€…</td>
            <td><input type="text" name="b_man" id="" value="<?php echo $b_man ?>" readonly> </td>
        </tr>
        <tr>
            <td>æ‰€å±åˆ†ç±»</td>
            <td>
                <select name="b_id" id="">
                    <?php foreach($arr as $k =>$v){ ?>
                    <option value="<?php echo $v['b_id'] ?>"><?php echo $v['b_cate'] ?></option>
                    <?php } ?>
                </select>
            </td>
        </tr>
        <tr>
            <td>å°é¢</td>
            <td><input type="file" name="b_img" id=""></td>
        </tr>
        <tr>
            <td>å†…å®¹</td>
            <td><textarea name="b_desc" id="" cols="30" rows="10"></textarea></td>
        </tr>
        <tr>
            <td><input type="submit" value="å‘å¸ƒ"></td>
            <td></td>
        </tr>
    </table>
</form>
</body>
</html>
<script>
    function check_name() {
     var b_name=document.getElementById('b_name').value;
     var span_name=document.getElementById('span_name');
     var res =/^[0-9a-zA-Z\u4e00-\u9fa5]{2-10}$/;
     if (b_name==''){
         span_name.innerHTML="<font color='red'>å›¾ä¹¦åç§°ä¸èƒ½ä¸ºç©º<font>"
         return false;
     } else if (b_name.test(b_name)==false) {
         span_name.innerHTML="<font color='red'>å›¾ä¹¦åç§°å¿…é¡»ç”±2-10ä½æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ç»„æˆ</font>"
         return false;
     }else{
         var aaa=false;
         var xhr = new XMLHttpRequest();
         xhr.onreadystatechange=function () {
             if (xhr.readyState==4&&xhr.status==200){
              if (xhr.responseText=='yes'){
                  span_name.innerHTML="<font color='red'>å›¾ä¹¦æ ‡é¢˜å·²å­˜åœ¨ </font>"
              }  else {
                  span_name.innerHTML="<font color='green'>ğŸ˜€âˆšğŸ˜€</font>"
              }

             }
         }
         xhr.open('get','/index.php/index/Index/ajax?b_name='+b_name,false );
         xhr.send(null);
         return sign;
     }
    }




</script>